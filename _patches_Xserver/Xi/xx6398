diff -uNr xserver690/xc/programs/Xserver/Xi/sendexev.c Xi/sendexev.c
--- xserver690/xc/programs/Xserver/Xi/sendexev.c	2005-07-03 09:01:07.000000000 +0200
+++ Xi/sendexev.c	2015-06-10 21:19:38.675212408 +0200
@@ -87,7 +87,7 @@
     register ClientPtr client;
     {
     register char n;
-    register long *p;
+    CARD32 *p;
     register int i;
     xEvent eventT;
     xEvent *eventP;
@@ -98,6 +98,11 @@
     REQUEST_AT_LEAST_SIZE(xSendExtensionEventReq);
     swapl(&stuff->destination, n);
     swaps(&stuff->count, n);
+
+    if (stuff->length != (sizeof(xSendExtensionEventReq) >> 2) + stuff->count +
+       (stuff->num_events * (sizeof(xEvent) >> 2)))
+       return BadLength;
+
     eventP = (xEvent *) &stuff[1];
     for (i=0; i<stuff->num_events; i++,eventP++)
         {
@@ -108,12 +113,8 @@
 	*eventP = eventT;
 	}
 
-    p = (long *) (((xEvent *) &stuff[1]) + stuff->num_events);
-    for (i=0; i<stuff->count; i++)
-        {
-        swapl(p, n);
-	p++;
-        }
+    p = (CARD32 *)(((xEvent *) & stuff[1]) + stuff->num_events);
+    SwapLongs(p, stuff->count);
     return(ProcXSendExtensionEvent(client));
     }
 
