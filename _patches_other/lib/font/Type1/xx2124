diff -uNr xserver690/xc/lib/font/Type1/afm.c nx-libs/nx-X11/lib/font/Type1/afm.c
--- xserver690/xc/lib/font/Type1/afm.c	2005-07-10 01:30:06.000000000 +0200
+++ nx-libs/nx-X11/lib/font/Type1/afm.c	2015-06-10 21:19:38.615212111 +0200
@@ -29,6 +29,7 @@
 #include <stdio.h>
 #include <string.h>
 #include <stdlib.h>
+#include <limits.h>
 #else
 #include "Xmd.h"        /* For INT32 declaration */
 #include "Xdefs.h"      /* For Bool */
@@ -118,6 +119,11 @@
             
             fi->nChars = atoi(p);
 
+	    if (fi->nChars < 0 || fi->nChars > INT_MAX / sizeof(Metrics)) {
+		xfree(afmbuf);
+		xfree(fi);
+		return(1);
+	    }
             fi->metrics = (Metrics *)xalloc(fi->nChars * 
                 sizeof(Metrics));
             if (fi->metrics == NULL) {
