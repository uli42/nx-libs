diff -uNr xserver690/xc/lib/font/bitmap/bdfread.c nx-libs/nx-X11/lib/font/bitmap/bdfread.c
--- xserver690/xc/lib/font/bitmap/bdfread.c	2005-07-09 08:36:12.000000000 +0200
+++ nx-libs/nx-X11/lib/font/bitmap/bdfread.c	2015-06-10 21:19:38.619212131 +0200
@@ -65,6 +65,12 @@
 #include <X11/fonts/bitmap.h>
 #include <X11/fonts/bdfint.h>
 
+#if HAVE_STDINT_H
+#include <stdint.h>
+#elif !defined(INT32_MAX)
+#define INT32_MAX 0x7fffffff
+#endif
+
 #define INDICES 256
 #define MAXENCODING 0xFFFF
 #define BDFLINELEN  1024
@@ -288,6 +294,11 @@
 	bdfError("invalid number of CHARS in BDF file\n");
 	return (FALSE);
     }
+    if (nchars > INT32_MAX / sizeof(CharInfoRec)) {
+	bdfError("Couldn't allocate pCI (%d*%d)\n", nchars,
+		 sizeof(CharInfoRec));
+	goto BAILOUT;
+    }
     ci = (CharInfoPtr) xalloc(nchars * sizeof(CharInfoRec));
     if (!ci) {
 	bdfError("Couldn't allocate pCI (%d*%d)\n", nchars,
