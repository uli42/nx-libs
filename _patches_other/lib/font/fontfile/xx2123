diff -uNr xserver690/xc/lib/font/fontfile/fontdir.c nx-libs/nx-X11/lib/font/fontfile/fontdir.c
--- xserver690/xc/lib/font/fontfile/fontdir.c	2005-11-14 21:40:42.000000000 +0100
+++ nx-libs/nx-X11/lib/font/fontfile/fontdir.c	2015-06-10 21:19:38.639212230 +0200
@@ -38,9 +38,17 @@
 #include    <X11/fonts/fntfilst.h>
 #include    <X11/keysym.h>
 
+#if HAVE_STDINT_H
+#include <stdint.h>
+#elif !defined(INT32_MAX)
+#define INT32_MAX 0x7fffffff
+#endif
+
 Bool
 FontFileInitTable (FontTablePtr table, int size)
 {
+    if (size < 0 || (size > INT32_MAX/sizeof(FontEntryRec))) 
+	return FALSE;
     if (size)
     {
 	table->entries = (FontEntryPtr) xalloc(sizeof(FontEntryRec) * size);
