diff -uNr xserver690/xc/lib/SM/sm_client.c nx-libs/nx-X11/lib/SM/sm_client.c
--- xserver690/xc/lib/SM/sm_client.c	2005-05-17 23:25:16.000000000 +0200
+++ nx-libs/nx-X11/lib/SM/sm_client.c	2015-06-10 21:19:38.515211615 +0200
@@ -239,7 +239,9 @@
 		    SIZEOF (smRegisterClientMsg), WORD64COUNT (extra),
 		    smRegisterClientMsg, pMsg, pData);
 
-		STORE_ARRAY8 (pData, 0, NULL);
+                previousId = NULL;
+
+		STORE_ARRAY8 (pData, 0, previousId);
 
 		IceFlush (iceConn);
 
