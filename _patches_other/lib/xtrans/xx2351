diff -uNr xserver690/xc/lib/xtrans/Xtranslcl.c nx-libs/nx-X11/lib/xtrans/Xtranslcl.c
--- xserver690/xc/lib/xtrans/Xtranslcl.c	2005-11-08 07:33:26.000000000 +0100
+++ nx-libs/nx-X11/lib/xtrans/Xtranslcl.c	2015-05-21 22:25:41.466996878 +0200
@@ -360,7 +360,10 @@
 	uid_t       saved_euid;
 
 	saved_euid = geteuid();
-	setuid( getuid() ); /** sets the euid to the actual/real uid **/
+	/** sets the euid to the actual/real uid **/
+	if (setuid( getuid() ) == -1) {
+		exit(1);
+	}
 	if( chown( slave, saved_euid, -1 ) < 0 ) {
 		exit( 1 );
 		}
@@ -369,7 +372,13 @@
     }
 
     waitpid(saved_pid, &exitval, 0);
-
+    if (WIFEXITED(exitval) && WEXITSTATUS(exitval) != 0) {
+	close(fd);
+	close(server);
+	PRMSG(1, "PTSOpenClient: cannot set the owner of %s\n",
+	      slave, 0, 0);
+	return(-1);
+    }
     if (chmod(slave, 0666) < 0) {
 	close(fd);
 	close(server);
